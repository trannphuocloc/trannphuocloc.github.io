---
title: "Data Analysis Project"
excerpt: "The process of data analysis using SQL and PowerBI to find the healthy employees for the bonus and highlight insights from the data. <br/><img src='/images/HRbackground.png'>"
collection: portfolio
author_profile: false
---

<i>This data analysis project was designed to showcase the concept of simulating a daily required task from the HR department to query and visualize the data on human resources with the wireframe, including the lifestyle of the employees—are they smokers or drinkers? to get the bonus program from the company.</i>

<h2>Requirements from HR departments</h2>

<ul>
  <li>Provide a list of Healthy Individuals & Low Absenteeism for the healthy bonus program (Total Budget: $1000 USD)</li>
  <li>Calculate a Wage Increase or annual compensation for Non-Smokers (Insurance Budget: $983,221)</li>
  <li>Create a Dashboard for HR to understand Absenteeism at work based on the approved wireframe.</li>
</ul>

<p>Employee data can be found in the CSV files located in the my repository here: <a href="https://github.com/trannphuocloc/HR-dataset-project">HR-dataset-project</a></p>

<h2>Project Details</h2>

<p>Start by creating a join table to combine all relevant datasets and ensure accurate employee information.</p>



<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <!-- Nhúng thư viện Prism.js -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/magula.min.css">

    <style>
        pre {
		display: inline-block;
            background-color: #f4f4f4;
            padding: 10px;
            border: 1px solid #ccc;
            overflow-x: auto;
            font-size: 14px;
        }
    </style>
  <title>Scrollable Code Block</title>
  <style>
      /* CSS để tạo nút cuộn cho block code */
      .scrollable-code {
          width: 600px; /* Chiều rộng của block code */
          height: 400px; /* Chiều cao của block code */
          overflow-x: auto; /* Tạo ra thanh cuộn ngang khi cần thiết */
          white-space: normal; /* Đảm bảo các dòng code không bị wrap */
          margin-top: 0; /* Khoảng cách phía trên */
          margin-bottom: 0; /* Khoảng cách phía dưới */
          margin-right: 0px;
          font-size: 14px;
          padding-bottom:0;

          
      }
      .scroll-button {
            
            margin-top: 0px; /* Khoảng cách từ nút cuộn đến văn bản trên */
            margin-bottom: 0;
            padding: 0; /* Điều chỉnh độ lớn của nút cuộn */
        }
</head>

<body>
  <style>
    table{
      font-size: 14px;
    }

    table thead th{
      background-color: #ccc;
        text-align: left;
    }

    .table.table-hover tr:hover{
      background: #d4d2d2 ;
    }
    .table.table-striped tbody tr:nth-child(even){
      background: #f0f0f0 ;
    }
    </style>

    <style>
        .odd {
            background-color: #f0f0f0;
        }

        .even {
            background-color: #ffffff;
        }
    </style>
</body>

<h4>Input [1]:</h4>
<pre><code class="language-sql" style="font-size: 14px;">SELECT * 
FROM Absenteeism_at_work a
LEFT JOIN compensation b
ON a.ID = b.ID
LEFT JOIN Reasons c
ON a.Reason_for_absence = c.Number;
</code></pre>


<h4>Output [1]:</h4>
<div style="overflow-x: auto;">
<table class="table table-striped table-hover" border="1" style="width: 2000px;">
  <thead>
    <tr>
      <th>ID</th>
      <th>Reason for absence</th>
      <th>Month of absence</th>
      <th>Day of the week</th>
      <th>Seasons</th>
      <th>Transportation expense</th>
      <th>Distance from Residence to Work</th>
      <th>Service time</th>
      <th>Age</th>
      <th>Work load Average/day</th>
      <th>Hit target</th>
      <th>Disciplinary failure</th>
      <th>Education</th>
      <th>Son</th>
      <th>Social drinker</th>
      <th>Social smoker</th>
      <th>Pet</th>
      <th>Weight</th>
      <th>Height</th>
      <th>Body mass index</th>
      <th>Absenteeism time in hours</th>
      <th>ID</th>
      <th>comp_hr</th>
      <th>Number</th>
      <th>Reason</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>26</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>289</td>
      <td>36</td>
      <td>13</td>
      <td>33</td>
      <td>239554</td>
      <td>97</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>90</td>
      <td>172</td>
      <td>30</td>
      <td>4</td>
      <td>1</td>
      <td>35</td>
      <td>26</td>
      <td>unjustified absence</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>118</td>
      <td>13</td>
      <td>18</td>
      <td>50</td>
      <td>239554</td>
      <td>97</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>98</td>
      <td>178</td>
      <td>31</td>
      <td>0</td>
      <td>2</td>
      <td>49</td>
      <td>0</td>
      <td>Unkown</td>
    </tr>
    <tr>
      <td>3</td>
      <td>23</td>
      <td>7</td>
      <td>4</td>
      <td>1</td>
      <td>179</td>
      <td>51</td>
      <td>18</td>
      <td>38</td>
      <td>239554</td>
      <td>97</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>89</td>
      <td>170</td>
      <td>31</td>
      <td>2</td>
      <td>3</td>
      <td>47</td>
      <td>23</td>
      <td>medical consultation</td>
    </tr>
    <tr>
      <td>4</td>
      <td>7</td>
      <td>7</td>
      <td>5</td>
      <td>1</td>
      <td>279</td>
      <td>5</td>
      <td>14</td>
      <td>39</td>
      <td>239554</td>
      <td>97</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>68</td>
      <td>168</td>
      <td>24</td>
      <td>4</td>
      <td>4</td>
      <td>51</td>
      <td>7</td>
      <td style="width: max-content;">Diseases of the eye and adnexa</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td style="width: 2%;">737</td>
      <td>11</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>235</td>
      <td>11</td>
      <td>14</td>
      <td>37</td>
      <td>264604</td>
      <td>93</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>88</td>
      <td>172</td>
      <td>29</td>
      <td>4</td>
      <td>737</td>
      <td>26</td>
      <td>11</td>
      <td style="width: max-content;">Diseases of the digestive system</td>
    </tr>
    <tr>
      <td>738</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>118</td>
      <td>14</td>
      <td>13</td>
      <td>40</td>
      <td>271219</td>
      <td>95</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>8</td>
      <td>98</td>
      <td>170</td>
      <td>34</td>
      <td>0</td>
      <td>738</td>
      <td>48</td>
      <td>0</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <td>739</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>231</td>
      <td>35</td>
      <td>14</td>
      <td>39</td>
      <td>271219</td>
      <td>95</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>100</td>
      <td>170</td>
      <td>35</td>
      <td>0</td>
      <td>739</td>
      <td>42</td>
      <td>0</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <td>740</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>3</td>
      <td>179</td>
      <td>45</td>
      <td>14</td>
      <td>53</td>
      <td>271219</td>
      <td>95</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>77</td>
      <td>175</td>
      <td>25</td>
      <td>0</td>
      <td>740</td>
      <td>55</td>
      <td>0</td>
      <td>Unknown</td>
    </tr>
  </tbody>
</table>
</div>
740 rows &times; 25 columns
<p><br>From this, we find the list of employees who are healthy individuals and have low absenteeism for the bonus program. With the assumption that healthy individuals are non-smokers and non-drinkers, their BMI is less than 25, and their absence time must be under the average of the list.</p>
<h4>Input [2]:</h4>
<div class="scrollable-code" class="scroll-button" style="height: 310px;">
<pre><code class="language-sql">SELECT * FROM Absenteeism_at_work a
LEFT JOIN compensation b
ON a.ID = b.ID
LEFT JOIN Reasons c
ON a.Reason_for_absence = c.Number
WHERE Social_drinker = 0 
AND Social_smoker = 0
AND Body_mass_index < 25
AND Absenteeism_time_in_hours < (SELECT AVG(Absenteeism_time_in_hours) FROM Absenteeism_at_work)
ORDER BY Absenteeism_time_in_hours;
</code></pre></div>

<h4>Output [2]:</h4>
<div style="overflow-x: auto;">
<table class="table table-striped table-hover" border="1" style="width: 1800px;">
  <thead>
    <tr>
      <th>#</th>
      <th>ID</th>
      <th>Reason for absence</th>
      <th>Month of absence</th>
      <th>Day of the week</th>
      <th>Seasons</th>
      <th>Transportation expense</th>
      <th>Distance from Residence to Work</th>
      <th>Service time</th>
      <th>Age</th>
      <th>Work load Average/day</th>
      <th>Hit target</th>
      <th>Disciplinary failure</th>
      <th>Education</th>
      <th>Son</th>
      <th>Social drinker</th>
      <th>Social smoker</th>
      <th>Pet</th>
      <th>Weight</th>
      <th>Height</th>
      <th>Body mass index</th>
      <th>Absenteeism time in hours</th>
      <th>ID</th>
      <th>comp_hr</th>
      <th>Number</th>
      <th>Reason</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>52</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>4</td>
      <td>225</td>
      <td>26</td>
      <td>9</td>
      <td>28</td>
      <td>241476</td>
      <td>92</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>69</td>
      <td>169</td>
      <td>24</td>
      <td>0</td>
      <td>52</td>
      <td>42</td>
      <td>0</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <td>2</td>
      <td>217</td>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>388</td>
      <td>15</td>
      <td>9</td>
      <td>50</td>
      <td>378884</td>
      <td>92</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>76</td>
      <td>178</td>
      <td>24</td>
      <td>0</td>
      <td>217</td>
      <td>42</td>
      <td>0</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <td>3</td>
      <td>531</td>
      <td>0</td>
      <td>10</td>
      <td>2</td>
      <td>4</td>
      <td>225</td>
      <td>26</td>
      <td>9</td>
      <td>28</td>
      <td>284853</td>
      <td>91</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>69</td>
      <td>169</td>
      <td>24</td>
      <td>0</td>
      <td>531</td>
      <td>25</td>
      <td>0</td>
      <td>Unknown</td>
    </tr>
    <tr>
      <td>4</td>
      <td>559</td>
      <td>13</td>
      <td>12</td>
      <td>6</td>
      <td>4</td>
      <td>179</td>
      <td>26</td>
      <td>9</td>
      <td>30</td>
      <td>280549</td>
      <td>98</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>56</td>
      <td>171</td>
      <td>19</td>
      <td>1</td>
      <td>559</td>
      <td>51</td>
      <td>13</td>
      <td style="width: 40%;">Diseases of the musculoskeletal system and connective tissue</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>108</td>
      <td>540</td>
      <td>23</td>
      <td>11</td>
      <td>6</td>
      <td>4</td>
      <td>225</td>
      <td>26</td>
      <td>9</td>
      <td>28</td>
      <td>268519</td>
      <td>93</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>69</td>
      <td>169</td>
      <td>24</td>
      <td>4</td>
      <td>540</td>
      <td>47</td>
      <td>23</td>
      <td>Medical Consultation</td>
    </tr>
    <tr>
      <td>109</td>
      <td>315</td>
      <td>1</td>
      <td>10</td>
      <td>4</td>
      <td>4</td>
      <td>179</td>
      <td>26</td>
      <td>9</td>
      <td>30</td>
      <td>265017</td>
      <td>88</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>56</td>
      <td>171</td>
      <td>19</td>
      <td>5</td>
      <td>315</td>
      <td>47</td>
      <td>1</td>
      <td>Certain Infectious and Parasitic Diseases</td>
    </tr>
    <tr>
      <td>110</td>
      <td>316</td>
      <td>7</td>
      <td>10</td>
      <td>4</td>
      <td>4</td>
      <td>179</td>
      <td>26</td>
      <td>9</td>
      <td>30</td>
      <td>265017</td>
      <td>88</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>56</td>
      <td>171</td>
      <td>19</td>
      <td>5</td>
      <td>316</td>
      <td>37</td>
      <td>7</td>
      <td>Diseases of the Eye and Adnexa</td>
    </tr>
    <tr>
      <td>111</td>
      <td>359</td>
      <td>23</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>225</td>
      <td>26</td>
      <td>9</td>
      <td>28</td>
      <td>330061</td>
      <td>100</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>69</td>
      <td>169</td>
      <td>24</td>
      <td>5</td>
      <td>359</td>
      <td>49</td>
      <td>23</td>
      <td>Medical Consultation</td>
    </tr>
  </tbody>
</table>
</div>
111 rows &times; 26 columns

<p><br>Here we have the list of company employees who have a healthy lifestyle that matches the selection criteria for the bonus program. The output comes with 111 employees.</p>

<h2>Requirement 2</h2>
<p>Let’s move on to the next requirement from HR: calculating a wage increase or annual compensation for the insurance budget of $983,221 for all non-smokers</p>

<i>Note: the requirement is to calculate a wage increase or annual compensation for the insurance budget of $983,221 for ALL NON-SMOKER, it shall not be the same list as the previous requirement.</i>

	
<p>Firstly, query the number of employees who are nonsmokers:</p>

<h4>Input [3]:</h4>
<pre><code class="language-sql" style="font-size: 14px;">SELECT COUNT(*) AS count_nonsmoker 
FROM Absenteeism_at_work
WHERE Social_smoker = 0;
</code></pre>

  <h4>Output [3]:</h4>
<table class="table table-hover" border="1">
  <thead>
    <tr>
      <th>count_nonsmoker</th>
     </tr>
  </thead>
  <tbody>
    <tr>
      <td>686</td>
    </tr>
    </tbody>
</table>

<p>Calculate the total number of hours nonsmokers worked in a year if they worked 8 hours per day, 5 days a week, for 52 weeks: <i>686 x 8 x 5 x 52 = 1426880 (hours)</i></p>

<p>Next, calculate how much the hourly wage of a nonsmoker increases as the company's insurance budget increases by $983,221: <i>983221/1426880 = 0.68907 ($/hour)</i> </p>

<p>Let's do it backward to see the cost in total for an employee per year after the company increases the insurance budget: <i>0.68907 x 8 x 5 x 52 = 1,433.26 ($/year)</i></p>

<p><b>The rise of 0.689 dollar per hour in an employee's hourly income may seem substantial, but a mere $1433 payment for a nonsmoker employee's insurance will have a significant impact on wellness and employee incentives.</b> That's just too tiny for the company to encourage employees to get a better lifestyle for the next bonus program.</p>

<h2>Requirement 3</h2>
<p>Before creating dashboard sections, as you can see from the two previous requirements, we query the data by using <code>SELECT *</code> all the time, which makes sense for people who just check out for the first time and want complete information. For some columns that we don't need in PowerBI, optimize the query again using:</p>

<h4>Input [4]:</h4>
<div class="scrollable-code" class="scroll-button" style="width: 580px;">
<pre><code class="language-sql" style="font-size: 14px;">SELECT 
	a.ID, 
	c.Reason,
	a.Month_of_absence,
	a.Body_mass_index,
CASE
	WHEN a.Body_mass_index < 18.5 THEN 'Underweight'
	WHEN a.Body_mass_index BETWEEN 18.5 AND 25 THEN 'Healthy'
	WHEN a.Body_mass_index BETWEEN 25 AND 30 THEN 'Overweight'
	WHEN a.Body_mass_index > 40 THEN 'Obese'
	ELSE 'Unknown'
END AS BMI_Caretory,
CASE 
	WHEN Month_of_absence IN (12,1,2) THEN 'Winter'
	WHEN Month_of_absence IN (3,4,5) THEN 'Spring'
	WHEN Month_of_absence IN (6,7,8) THEN 'Summer'
	WHEN Month_of_absence IN (9,10,11) THEN 'Fall'
	ELSE 'Unknown'
END AS seasons_name,
	Seasons,
	Month_of_absence,
	Day_of_the_week,
	Transportation_expense,
	Education,
	Son,
	Social_drinker,
	Social_smoker,
	Pet,
	Disciplinary_failure,
	Age,
	Work_load_Average_day,
	Absenteeism_time_in_hours
FROM Absenteeism_at_work a
LEFT JOIN compensation b
ON a.ID = b.ID
LEFT JOIN Reasons c
ON a.Reason_for_absence = c.Number;
</code></pre></div>

	
<p>And we will use it to create a dashboard using PowerBI with a frame approved by HR departments here.</p>
<p><strong>The wireframe</strong></p>
<p><img src="/images/wireframe1.png" alt="This is an alt text." title="This is a sample image."></p>
<p>And check <a href="https://app.powerbi.com/view?r=eyJrIjoiMGYzMGJjNzktZmQ0OS00MDY4LWEzZTMtZjE1NDkwODdhMzg3IiwidCI6Ijc3ZGIwZDg5LTgyNzAtNGQwNy05NGY4LWNlZDhkYTVjNThjNiIsImMiOjEwfQ%3D%3D">my final report</a> here in PowerBI.</p>

<h2>Insights and Recomendation from the data</h2>
<h3>Insight 1</h3>
<p>By filtering the <strong>Count of Reason</strong>, it is simple to identify the 4 most common reasons, all of which are related to the employee's health: 385/740, or 52.02%, that employees mentioned when they asked for absence permission. </p>
<p>Furthermore, if we include all the health-related factors, the percentage could be more than 70%, and it has a significant impact on the employee's performance throughout the week, not only at the beginning of the week.</p>
<p><img src="/images/insight2.png" alt="This is an alt text." title="This is a sample image."></p>
<p><b>Recomendation:</b></p>
<ul>
<li>For this reason, HR departments pay attention to the employee's health in their workplace and have a plan to provide insurance for employees by analyzing more employee's data to have a specific policy.</li>
</ul>
	
<h3>Insight 2</h3>
<p>As the report shows in the graph of <strong>Sum of Absenteeism time in hour by Day of the week</strong>, amount of employees's absence time is highest on Monday of the week and decreases steadily until the end of the week. That's a lot of sense in reality, and there are a lot of factors that could have contributed to this, such as employees unfortunately getting into an unexpected situation for their health reasons (<strong>Insight 1</strong>) where they couldn't go to work at the beginning of the week, or in another scenario, employees may spend much time on their entertainment activities at the previous weekend.</p>
<p><img src="/images/insight4.png" alt="This is an alt text." title="This is a sample image."></p>
<p><b>Recomendation:</b></p>
<ul>
<li>Adjusting or reducing the working time to adapt the employee's reality schedule by adjusting from 8 a.m-5 p.m to 10 a.m - 7 p.m or reducing working hours from 8 a.m - 5 p.m to 10 a.m - 5 p.m, will guarantee  employees get high performance at the beginning of the week.</li>
<li>Establishing policies that encourage employees to reduce their absence time at the beginning of the week, like providing more employees's welfare on Monday, Tuesday, and Wednesday.</li>
</ul>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script> hljs.highlightAll();</script>

